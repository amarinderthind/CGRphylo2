Checking for deprecated package usage... OK
Checking for remote package usage... OK
Checking for 'LazyData: true' usage... OK
Checking version number... OK
Checking version number validity... OK
Checking R version dependency...
Update R version dependency from 4.4.0 to 4.5.0
Checking package size... OK
Checking individual file sizes... OK
Checking biocViews... OK
Checking that biocViews are present... OK
Checking package type based on biocViews... OK
Checking for non-trivial biocViews... OK
Checking that biocViews come from the same category... OK
Checking biocViews validity... OK
Checking for recommended biocViews... OK
Checking build system compatibility... OK
Checking for proper Description: field... OK
Checking if DESCRIPTION is well formatted... OK
Checking for whitespace in DESCRIPTION field names... OK
Checking that Package field matches directory/tarball name... OK
Checking for Version: field... OK
Checking for valid maintainer... OK
Checking License: for restrictive use... OK
Checking for recommended DESCRIPTION fields... OK
Checking for Bioconductor software dependencies...
No Bioconductor dependencies detected. Note that some
            infrastructure packages may not have Bioconductor dependencies.
            For more information, reach out to the Bioconductor community
            and/or consider a CRAN submission.
Checking for pinned package versions in DESCRIPTION... OK
Checking for 'fnd' role in Authors@R...
No 'fnd' role found in Authors@R. If the work is supported
        by a grant, consider adding the 'fnd' role to the list of authors.
Checking .Rbuildignore... OK
Checking for stray BiocCheck output folders... OK
Checking for inst/doc folders... OK
Checking vignette directory...
Evaluate more vignette chunks.
Checking package installation calls in R code... OK
Checking for library/require of CGRphylo2... OK
Checking coding practice...
 Avoid sapply(); use vapply()
Found in files:
R/cgat_function.R (line 186, column 15)
R/cgat_function.R (line 232, column 14)
R/cgat_function.R (line 233, column 18)
R/cgat_function.R (line 238, column 17)
R/distances_and_export.R (line 56, column 17)
R/distances_and_export.R (line 123, column 18)
 Avoid 1:...; use seq_len() or seq_along()
Found in files:
cgat_function.R (line 87, column 15)
distances_and_export.R (line 56, column 24)
 Avoid the use of 'paste' in condition signals
Found in files:
R/cgat_function.R (line 193, column 11)
R/distances_and_export.R (line 65, column 11)
R/distances_and_export.R (line 132, column 11)
R/distances_and_export.R (line 236, column 11)
Checking parsed R code in R directory, examples, vignettes... OK
Checking function lengths... OK
Checking man page documentation...
At least 80% of man pages documenting exported objects must have runnable examples.
The following pages do not:
calculateDistanceMatrix.Rd
cgrplot.Rd
parallelCGR.Rd
plot_cgr.Rd
saveMegaDistance.Rd
savePhylipDistance.Rd
Usage of dontrun{} / donttest{} tags found in man page examples. 60% of man pages use at least one of these tags.
Found in files:
calculateDistanceMatrix.Rd
cgrplot.Rd
parallelCGR.Rd
plot_cgr.Rd
saveMegaDistance.Rd
savePhylipDistance.Rd
Use donttest{} instead of dontrun{}.
Found in files:
calculateDistanceMatrix.Rd
cgrplot.Rd
parallelCGR.Rd
plot_cgr.Rd
saveMegaDistance.Rd
savePhylipDistance.Rd
Checking package NEWS... OK
Checking unit tests... OK
Checking skip_on_bioc() in tests... OK
Checking formatting of DESCRIPTION, NAMESPACE, man pages, R source, and vignette source...
Consider shorter lines; 32 lines (3%) are > 80 characters long.
First few lines:
R/cgat_function.R#L14 #' @param seq_index Integer. The index o ...
R/cgat_function.R#L17 #'   consistent comparison. Usually set  ...
R/cgat_function.R#L20 #'   given sequence. The matrix has 4^k  ...
R/cgat_function.R#L23 #' The function creates a frequency matr ...
R/cgat_function.R#L24 #' frequency is calculated from the DNA  ...
R/cgat_function.R#L25 #' used to compute distances between seq ...
R/cgat_function.R#L27 #' The CGR method is particularly effici ...
R/cgat_function.R#L28 #' cost of adding a new sequence is just ...
R/cgat_function.R#L55 #' SARS-CoV-2 Lineages, Newly Emerging S ...
R/cgat_function.R#L150     stop("Invalid distance_type. Choose  ...
R/cgat_function.R#L210 #' @return data.frame. A data frame with ...
R/cgrplot.R#L20 #' halfway from the current position to  ...
R/distances_and_export.R#L13 #' MEGA (Molecular Evolutionary Genetics ...
R/distances_and_export.R#L74 #' @param filename Character. Output fil ...
R/distances_and_export.R#L86 #' PHYLIP format is widely supported by  ...
R/distances_and_export.R#L87 #' limits sequence names to 10 character ...
R/distances_and_export.R#L91 #' PHYLIP format specification: http://w ...
R/distances_and_export.R#L132   message(paste("Distance matrix saved t ...
R/distances_and_export.R#L138 #' Computes a full pairwise distance mat ...
R/distances_and_export.R#L140 #' @param freq_matrices List. A named li ...
R/distances_and_export.R#L162 calculateDistanceMatrix <- function(freq ...
R/distances_and_export.R#L192 #' @param sequences List. A list of DNA  ...
vignettes/CGRphylo_introduction.Rmd#L2 title: "Introduction to CGRphylo2: Chaos ...
vignettes/CGRphylo_introduction.Rmd#L43     formats (MEGA, PHYLIP, Newick). Earl ...
vignettes/CGRphylo_introduction.Rmd#L48 **CGRphylo2** provides an efficient alig ...
vignettes/CGRphylo_introduction.Rmd#L50 - ✨ **Precision**: Accurately classifies ...
vignettes/CGRphylo_introduction.Rmd#L51 - ✨ **Speed**: 5-13.7× faster than tradi ...
vignettes/CGRphylo_introduction.Rmd#L69 > SARS-CoV-2 Lineages, Newly Emerging St ...
vignettes/CGRphylo_introduction.Rmd#L70 > 24(3). [doi:10.2174/138920292466623051 ...
vignettes/CGRphylo_introduction.Rmd#L97 This example demonstrates the complete C ...
vignettes/CGRphylo_introduction.Rmd#L128 The k-mer size determines the resolution ...
vignettes/CGRphylo_introduction.Rmd#L443    classification of species assessed by ...
Consider multiples of 4 spaces for line indents; 220 lines (20%) are not.
First few lines:
R/cgat_function.R#L60   # Get the sequence from the global fas ...
R/cgat_function.R#L61   sequence <- fasta_filtered[[seq_index] ...
R/cgat_function.R#L62    ...
R/cgat_function.R#L63   # Trim sequence to specified length ...
R/cgat_function.R#L64   sequence <- substr(sequence, 1, len_tr ...
R/cgat_function.R#L65    ...
R/cgat_function.R#L66   # Convert to uppercase ...
R/cgat_function.R#L67   sequence <- toupper(sequence) ...
R/cgat_function.R#L68    ...
R/cgat_function.R#L69   # Remove any non-ACGT characters ...
R/cgat_function.R#L70   sequence <- gsub("[^ACGT]", "", sequen ...
R/cgat_function.R#L71    ...
R/cgat_function.R#L72   # Calculate total number of possible k ...
R/cgat_function.R#L73   n_kmers <- 4^k_mer ...
R/cgat_function.R#L74    ...
R/cgat_function.R#L75   # Generate all possible k-mers ...
R/cgat_function.R#L76   bases <- c("A", "C", "G", "T") ...
R/cgat_function.R#L77   all_kmers <- expand.grid(rep(list(base ...
R/cgat_function.R#L78   all_kmers <- apply(all_kmers, 1, paste ...
R/cgat_function.R#L79    ...
R/cgat_function.R#L80   # Initialize frequency matrix ...
R/cgat_function.R#L81   freq_matrix <- matrix(0, nrow = n_kmer ...
R/cgat_function.R#L82   rownames(freq_matrix) <- all_kmers ...
R/cgat_function.R#L83    ...
R/cgat_function.R#L84   # Count k-mer frequencies ...
R/cgat_function.R#L85   seq_length <- nchar(sequence) ...
R/cgat_function.R#L86   if (seq_length >= k_mer) { ...
R/cgat_function.R#L88       kmer <- substr(sequence, i, i + k_ ...
R/cgat_function.R#L89       if (kmer %in% all_kmers) { ...
R/cgat_function.R#L91       } ...
R/cgat_function.R#L97       freq_matrix <- freq_matrix / total ...
R/cgat_function.R#L99   } ...
R/cgat_function.R#L100    ...
R/cgat_function.R#L101   return(freq_matrix) ...
R/cgat_function.R#L143   if (distance_type == "Euclidean") { ...
R/cgat_function.R#L145   } else if (distance_type == "S_Euclide ...
R/cgat_function.R#L147   } else if (distance_type == "Manhattan ...
R/cgat_function.R#L149   } else { ...
R/cgat_function.R#L151   } ...
R/cgat_function.R#L152   return(dist) ...
R/cgat_function.R#L185   # Count N's in each sequence ...
R/cgat_function.R#L186   n_counts <- sapply(fastafile, function ...
R/cgat_function.R#L188   }) ...
R/cgat_function.R#L189    ...
R/cgat_function.R#L190   # Filter sequences ...
R/cgat_function.R#L191   filtered <- fastafile[n_counts <= N_fi ...
R/cgat_function.R#L192    ...
R/cgat_function.R#L193   message(paste( ...
R/cgat_function.R#L196   )) ...
R/cgat_function.R#L197    ...
R/cgat_function.R#L198   return(filtered) ...
R/cgat_function.R#L230   meta_df <- data.frame( ...
R/cgat_function.R#L234       bases <- strsplit(toupper(seq), "" ...
R/cgat_function.R#L235       gc_count <- sum(bases %in% c("G",  ...
R/cgat_function.R#L236       gc_count / length(bases) * 100 ...
R/cgat_function.R#L239       bases <- strsplit(toupper(seq), "" ...
R/cgat_function.R#L240       n_count <- sum(bases == "N") ...
R/cgat_function.R#L241       n_count ...
R/cgat_function.R#L244   ) ...
R/cgat_function.R#L245    ...
R/cgat_function.R#L246   return(meta_df) ...
R/cgrplot.R#L53   # Get the sequence from the global fas ...
R/cgrplot.R#L54   sequence <- fasta_filtered[[seq_index] ...
R/cgrplot.R#L56   # Convert to uppercase and split into  ...
R/cgrplot.R#L57   sequence <- toupper(sequence) ...
R/cgrplot.R#L58   bases <- strsplit(sequence, "")[[1]] ...
R/cgrplot.R#L60   # Remove non-ACGT bases ...
R/cgrplot.R#L61   bases <- bases[bases %in% c("A", "C",  ...
R/cgrplot.R#L63   # Define corner positions for each bas ...
R/cgrplot.R#L64   corners <- list( ...
R/cgrplot.R#L69   ) ...
R/cgrplot.R#L71   # Initialize starting position (center ...
R/cgrplot.R#L72   current_pos <- c(0.5, 0.5) ...
R/cgrplot.R#L74   # Initialize matrix to store coordinat ...
R/cgrplot.R#L75   n_bases <- length(bases) ...
R/cgrplot.R#L76   cgr_coords <- matrix(0, nrow = n_bases ...
R/cgrplot.R#L77   colnames(cgr_coords) <- c("x", "y") ...
R/cgrplot.R#L79   # Calculate CGR coordinates ...
R/cgrplot.R#L80   for (i in seq_len(n_bases)) { ...
R/cgrplot.R#L83       # Move halfway to the corner of th ...
R/cgrplot.R#L84       corner <- corners[[base]] ...
R/cgrplot.R#L85       current_pos <- (current_pos + corn ...
R/cgrplot.R#L86       cgr_coords[i, ] <- current_pos ...
R/cgrplot.R#L88   } ...
R/cgrplot.R#L90   return(cgr_coords) ...
R/cgrplot.R#L118                      col = "black", ...) ...
R/cgrplot.R#L119   cgr_coords <- cgrplot(seq_index) ...
R/cgrplot.R#L121   if (is.null(main)) { ...
R/cgrplot.R#L123   } ...
R/cgrplot.R#L125   plot(cgr_coords[, 1], cgr_coords[, 2], ...
R/cgrplot.R#L132   ) ...
R/distances_and_export.R#L29   n <- nrow(distance_matrix) ...
R/distances_and_export.R#L30   seq_names <- rownames(distance_matrix) ...
R/distances_and_export.R#L32   # Open file connection ...
R/distances_and_export.R#L33   con <- file(filename, "w") ...
R/distances_and_export.R#L35   # Write header ...
R/distances_and_export.R#L36   writeLines("#mega", con) ...
R/distances_and_export.R#L37   writeLines("!Title: Distance Matrix;", ...
R/distances_and_export.R#L38   writeLines(paste("!Format DataType=Dis ...
R/distances_and_export.R#L41   ), con) ...
R/distances_and_export.R#L42   writeLines("", con) ...
R/distances_and_export.R#L44   # Write sequence names ...
R/distances_and_export.R#L45   writeLines("[", con) ...
R/distances_and_export.R#L46   for (i in seq_len(n)) { ...
R/distances_and_export.R#L48   } ...
R/distances_and_export.R#L49   writeLines("]", con) ...
R/distances_and_export.R#L50   writeLines("", con) ...
R/distances_and_export.R#L52   # Write distance matrix (lower triangu ...
R/distances_and_export.R#L53   for (i in seq_len(n)) { ...
R/distances_and_export.R#L56       values <- sapply(1:(i - 1), functi ...
R/distances_and_export.R#L58       }) ...
R/distances_and_export.R#L59       line <- paste(line, paste(values,  ...
R/distances_and_export.R#L62   } ...
R/distances_and_export.R#L64   close(con) ...
R/distances_and_export.R#L65   message(paste("Distance matrix saved t ...
R/distances_and_export.R#L105   n <- nrow(distance_matrix) ...
R/distances_and_export.R#L106   seq_names <- rownames(distance_matrix) ...
R/distances_and_export.R#L108   # Truncate names if original mode ...
R/distances_and_export.R#L109   if (mode == "original") { ...
R/distances_and_export.R#L112   } ...
R/distances_and_export.R#L114   # Open file connection ...
R/distances_and_export.R#L115   con <- file(filename, "w") ...
R/distances_and_export.R#L117   # Write header (number of taxa) ...
R/distances_and_export.R#L118   writeLines(paste("  ", n, sep = ""), c ...
R/distances_and_export.R#L120   # Write distance matrix ...
R/distances_and_export.R#L121   for (i in seq_len(n)) { ...
R/distances_and_export.R#L124       format(round(distance_matrix[i, j] ...
R/distances_and_export.R#L129   } ...
R/distances_and_export.R#L131   close(con) ...
R/distances_and_export.R#L132   message(paste("Distance matrix saved t ...
R/distances_and_export.R#L163   n <- length(freq_matrices) ...
R/distances_and_export.R#L164   seq_names <- names(freq_matrices) ...
R/distances_and_export.R#L166   # Initialize distance matrix ...
R/distances_and_export.R#L167   distance <- matrix(0, nrow = n, ncol = ...
R/distances_and_export.R#L168   rownames(distance) <- colnames(distanc ...
R/distances_and_export.R#L170   # Calculate pairwise distances ...
R/distances_and_export.R#L171   for (i in seq_len(n)) { ...
R/distances_and_export.R#L173       distance[i, j] <- matrixDistance(f ...
R/distances_and_export.R#L176       ) ...
R/distances_and_export.R#L178   } ...
R/distances_and_export.R#L180   # Round to reasonable precision ...
R/distances_and_export.R#L181   distance <- round(distance, 6) ...
R/distances_and_export.R#L183   return(distance) ...
R/distances_and_export.R#L218   # Set up global environment for cgat f ...
R/distances_and_export.R#L219   assign("fasta_filtered", sequences, en ...
R/distances_and_export.R#L221   # Determine number of cores ...
R/distances_and_export.R#L222   if (is.null(num_cores)) { ...
R/distances_and_export.R#L225   } ...
R/distances_and_export.R#L227   seq_names <- names(sequences) ...
R/distances_and_export.R#L228   n_seq <- length(sequences) ...
R/distances_and_export.R#L230   # Process function wrapper ...
R/distances_and_export.R#L231   process_sequence <- function(n) { ...
R/distances_and_export.R#L234   } ...
R/distances_and_export.R#L236   message(paste("Processing", n_seq, "se ...
R/distances_and_export.R#L238   # Use parallel processing on Unix-like ...
R/distances_and_export.R#L239   if (.Platform$OS.type == "unix") { ...
R/distances_and_export.R#L241       process_sequence, ...
R/distances_and_export.R#L242       mc.cores = num_cores ...
R/distances_and_export.R#L244   } else { ...
R/distances_and_export.R#L248   } ...
R/distances_and_export.R#L250   # Assign names ...
R/distances_and_export.R#L251   names(freq_matrices) <- seq_names ...
R/distances_and_export.R#L253   message("Processing complete!") ...
R/distances_and_export.R#L255   return(freq_matrices) ...
vignettes/CGRphylo_introduction.Rmd#L17   echo = TRUE, warning = FALSE, message  ...
vignettes/CGRphylo_introduction.Rmd#L18   fig.width = 7, fig.height = 5 ...
vignettes/CGRphylo_introduction.Rmd#L78   install.packages("BiocManager") ...
vignettes/CGRphylo_introduction.Rmd#L89   install.packages("devtools") ...
vignettes/CGRphylo_introduction.Rmd#L112   seqtype = "DNA", ...
vignettes/CGRphylo_introduction.Rmd#L113   as.string = TRUE, ...
vignettes/CGRphylo_introduction.Rmd#L114   set.attributes = FALSE ...
vignettes/CGRphylo_introduction.Rmd#L136   k_mer = k_mer, ...
vignettes/CGRphylo_introduction.Rmd#L137   len_trim = len_trim ...
vignettes/CGRphylo_introduction.Rmd#L146   distance_type = "Euclidean" ...
vignettes/CGRphylo_introduction.Rmd#L195   labels = meta$name, ...
vignettes/CGRphylo_introduction.Rmd#L196   xlab = "Sequence length", ...
vignettes/CGRphylo_introduction.Rmd#L197   pch = 21, bg = "green", pt.cex = 1, ce ...
vignettes/CGRphylo_introduction.Rmd#L202   labels = meta$name, ...
vignettes/CGRphylo_introduction.Rmd#L203   xlab = "GC content (%)", ...
vignettes/CGRphylo_introduction.Rmd#L204   pch = 21, bg = "blue", pt.cex = 1, cex ...
vignettes/CGRphylo_introduction.Rmd#L218   geom_boxplot() + ...
vignettes/CGRphylo_introduction.Rmd#L219   coord_flip() + ...
vignettes/CGRphylo_introduction.Rmd#L220   ylab("Sequence length") + ...
vignettes/CGRphylo_introduction.Rmd#L221   theme_minimal() ...
vignettes/CGRphylo_introduction.Rmd#L232   main = paste("CGR of", names(fasta_fil ...
vignettes/CGRphylo_introduction.Rmd#L233   xlab = "", ylab = "", ...
vignettes/CGRphylo_introduction.Rmd#L234   cex = 0.2, pch = 4 ...
vignettes/CGRphylo_introduction.Rmd#L243   main = names(fasta_filtered)[1], ...
vignettes/CGRphylo_introduction.Rmd#L244   cex = 0.3, pch = 4, col = "blue" ...
vignettes/CGRphylo_introduction.Rmd#L248   main = names(fasta_filtered)[2], ...
vignettes/CGRphylo_introduction.Rmd#L249   cex = 0.3, pch = 4, col = "red" ...
vignettes/CGRphylo_introduction.Rmd#L260   distance_type = "Euclidean" ...
vignettes/CGRphylo_introduction.Rmd#L265   distance_type = "Manhattan" ...
vignettes/CGRphylo_introduction.Rmd#L270   distance_type = "S_Euclidean" ...
vignettes/CGRphylo_introduction.Rmd#L284   # Calculate frequencies ...
vignettes/CGRphylo_introduction.Rmd#L285   freq <- parallelCGR(fasta_filtered, k_ ...
vignettes/CGRphylo_introduction.Rmd#L287   # Calculate distances ...
vignettes/CGRphylo_introduction.Rmd#L288   dist <- calculateDistanceMatrix(freq,  ...
vignettes/CGRphylo_introduction.Rmd#L290   # Build tree ...
vignettes/CGRphylo_introduction.Rmd#L291   trees[[paste0("k", k)]] <- nj(as.dist( ...
vignettes/CGRphylo_introduction.Rmd#L297   plot(trees[[paste0("k", k)]], ...
vignettes/CGRphylo_introduction.Rmd#L300   ) ...
vignettes/CGRphylo_introduction.Rmd#L312    - Move halfway toward the corner repr ...
vignettes/CGRphylo_introduction.Rmd#L313    - A → (0,0), C → (1,0), G → (1,1), T  ...
vignettes/CGRphylo_introduction.Rmd#L339   k_mer = 6, ...
vignettes/CGRphylo_introduction.Rmd#L340   len_trim = len_trim, ...
vignettes/CGRphylo_introduction.Rmd#L341   num_cores = NULL ...
vignettes/CGRphylo_introduction.Rmd#L346   k_mer = 6, ...
vignettes/CGRphylo_introduction.Rmd#L347   len_trim = len_trim, ...
vignettes/CGRphylo_introduction.Rmd#L348   num_cores = 4 ...
vignettes/CGRphylo_introduction.Rmd#L365   start_idx <- (i - 1) * batch_size + 1 ...
vignettes/CGRphylo_introduction.Rmd#L366   end_idx <- min(i * batch_size, n_seque ...
vignettes/CGRphylo_introduction.Rmd#L368   batch_seqs <- fasta_filtered[start_idx ...
vignettes/CGRphylo_introduction.Rmd#L369   batch_freq <- parallelCGR(batch_seqs,  ...
vignettes/CGRphylo_introduction.Rmd#L371   all_freq_matrices <- c(all_freq_matric ...
vignettes/CGRphylo_introduction.Rmd#L436    SARS-CoV-2 Lineages, Newly Emerging S ...
vignettes/CGRphylo_introduction.Rmd#L437    *Current Genomics*, 24(3). ...
vignettes/CGRphylo_introduction.Rmd#L440    *Nucleic Acids Research*, 18(8):2163- ...
vignettes/CGRphylo_introduction.Rmd#L443    classification of species assessed by ...
vignettes/CGRphylo_introduction.Rmd#L444    *Molecular Biology and Evolution*, 16 ...
Checking if package already exists in CRAN... OK
Checking for bioc-devel mailing list subscription...
Cannot determine whether maintainer is subscribed to the Bioc-Devel mailing list (requires admin credentials). Subscribe here: https://stat.ethz.ch/mailman/listinfo/bioc-devel
Checking for support site registration...
Add package to Watched Tags in your Support Site profile; visit https://support.bioconductor.org/accounts/edit/profile
