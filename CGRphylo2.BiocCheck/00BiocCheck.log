Checking for deprecated package usage... OK
Checking for remote package usage... OK
Checking for 'LazyData: true' usage... OK
Checking version number... OK
Checking version number validity... OK
Checking R version dependency...
Update R version dependency from 4.4.0 to 4.5.0
Checking package size... OK
Checking individual file sizes... OK
Checking biocViews... OK
Checking that biocViews are present... OK
Checking package type based on biocViews... OK
Checking for non-trivial biocViews... OK
Checking that biocViews come from the same category... OK
Checking biocViews validity... OK
Checking for recommended biocViews... OK
Checking build system compatibility... OK
Checking for proper Description: field... OK
Checking if DESCRIPTION is well formatted... OK
Checking for whitespace in DESCRIPTION field names... OK
Checking that Package field matches directory/tarball name... OK
Checking for Version: field... OK
Checking for valid maintainer... OK
Checking License: for restrictive use... OK
Checking for recommended DESCRIPTION fields... OK
Checking for Bioconductor software dependencies...
No Bioconductor dependencies detected. Note that some
            infrastructure packages may not have Bioconductor dependencies.
            For more information, reach out to the Bioconductor community
            and/or consider a CRAN submission.
Checking for pinned package versions in DESCRIPTION... OK
Checking for 'fnd' role in Authors@R...
No 'fnd' role found in Authors@R. If the work is supported
        by a grant, consider adding the 'fnd' role to the list of authors.
Checking .Rbuildignore... OK
Checking for stray BiocCheck output folders... OK
Checking for inst/doc folders... OK
Checking vignette directory... OK
Checking package installation calls in R code... OK
Checking for library/require of CGRphylo2... OK
Checking coding practice... OK
Checking parsed R code in R directory, examples, vignettes... OK
Checking function lengths... OK
Checking man page documentation...
Consider adding runnable examples to man pages that document exported objects.
cgrplot.Rd
plot_cgr.Rd
Usage of dontrun{} / donttest{} tags found in man page examples. 20% of man pages use at least one of these tags.
Found in files:
cgrplot.Rd
plot_cgr.Rd
Use donttest{} instead of dontrun{}.
Found in files:
cgrplot.Rd
plot_cgr.Rd
Checking package NEWS... OK
Checking unit tests... OK
Checking skip_on_bioc() in tests... OK
Checking formatting of DESCRIPTION, NAMESPACE, man pages, R source, and vignette source...
Consider shorter lines; 13 lines (1%) are > 80 characters long.
First few lines:
R/cgat_function.R#L91     for (i in seq_len(seq_length - k_mer ...
R/cgat_function.R#L155     stop("Invalid distance_type. Choose  ...
R/cgrplot.R#L20 #' halfway from the current position to  ...
R/distances_and_export.R#L185 #' dist_matrix <- calculateDistanceMatri ...
vignettes/CGRphylo_introduction.Rmd#L2 title: "Introduction to CGRphylo2: Chaos ...
vignettes/CGRphylo_introduction.Rmd#L76 > [doi:10.2174/1389202924666230517115655 ...
vignettes/CGRphylo_introduction.Rmd#L161 ```{r metadata, fig.cap="Sequence length ...
vignettes/CGRphylo_introduction.Rmd#L204 ```{r cgr_plots, fig.cap="CGR plots for  ...
vignettes/CGRphylo_introduction.Rmd#L234 ```{r heatmap, fig.cap="Pairwise Euclide ...
vignettes/CGRphylo_introduction.Rmd#L256 ```{r build_tree, fig.cap="Neighbour-joi ...
vignettes/CGRphylo_introduction.Rmd#L312 ```{r distance_methods, fig.cap="NJ tree ...
vignettes/CGRphylo_introduction.Rmd#L325 ```{r kmer_comparison, fig.cap="NJ trees ...
vignettes/CGRphylo_introduction.Rmd#L329                             num_cores =  ...
Consider multiples of 4 spaces for line indents; 200 lines (18%) are not.
First few lines:
R/cgat_function.R#L64   # Get the sequence from the global fas ...
R/cgat_function.R#L65   sequence <- fasta_filtered[[seq_index] ...
R/cgat_function.R#L66    ...
R/cgat_function.R#L67   # Trim sequence to specified length ...
R/cgat_function.R#L68   sequence <- substr(sequence, 1, len_tr ...
R/cgat_function.R#L69    ...
R/cgat_function.R#L70   # Convert to uppercase ...
R/cgat_function.R#L71   sequence <- toupper(sequence) ...
R/cgat_function.R#L72    ...
R/cgat_function.R#L73   # Remove any non-ACGT characters ...
R/cgat_function.R#L74   sequence <- gsub("[^ACGT]", "", sequen ...
R/cgat_function.R#L75    ...
R/cgat_function.R#L76   # Calculate total number of possible k ...
R/cgat_function.R#L77   n_kmers <- 4^k_mer ...
R/cgat_function.R#L78    ...
R/cgat_function.R#L79   # Generate all possible k-mers ...
R/cgat_function.R#L80   bases <- c("A", "C", "G", "T") ...
R/cgat_function.R#L81   all_kmers <- expand.grid(rep(list(base ...
R/cgat_function.R#L82   all_kmers <- apply(all_kmers, 1, paste ...
R/cgat_function.R#L83    ...
R/cgat_function.R#L84   # Initialize frequency matrix ...
R/cgat_function.R#L85   freq_matrix <- matrix(0, nrow = n_kmer ...
R/cgat_function.R#L86   rownames(freq_matrix) <- all_kmers ...
R/cgat_function.R#L87    ...
R/cgat_function.R#L88   # Count k-mer frequencies ...
R/cgat_function.R#L89   seq_length <- nchar(sequence) ...
R/cgat_function.R#L90   if (seq_length >= k_mer) { ...
R/cgat_function.R#L92       kmer <- substr(sequence, i, i + k_ ...
R/cgat_function.R#L93       if (kmer %in% all_kmers) { ...
R/cgat_function.R#L95       } ...
R/cgat_function.R#L101       freq_matrix <- freq_matrix / total ...
R/cgat_function.R#L103   } ...
R/cgat_function.R#L104    ...
R/cgat_function.R#L105   return(freq_matrix) ...
R/cgat_function.R#L147   if (distance_type == "Euclidean") { ...
R/cgat_function.R#L149   } else if (distance_type == "S_Euclide ...
R/cgat_function.R#L151   } else if (distance_type == "Manhattan ...
R/cgat_function.R#L153   } else { ...
R/cgat_function.R#L156   } ...
R/cgat_function.R#L157   return(dist) ...
R/cgat_function.R#L190   # FIX: was sapply(); vapply() enforces ...
R/cgat_function.R#L191   n_counts <- vapply(fastafile, function ...
R/cgat_function.R#L193   }, FUN.VALUE = integer(1)) ...
R/cgat_function.R#L194    ...
R/cgat_function.R#L195   # Filter sequences ...
R/cgat_function.R#L196   filtered <- fastafile[n_counts <= N_fi ...
R/cgat_function.R#L197    ...
R/cgat_function.R#L198   # FIX: was message(paste(...)); messag ...
R/cgat_function.R#L199   message( ...
R/cgat_function.R#L202   ) ...
R/cgat_function.R#L203    ...
R/cgat_function.R#L204   return(filtered) ...
R/cgat_function.R#L237   meta_df <- data.frame( ...
R/cgat_function.R#L242       bases <- strsplit(toupper(seq), "" ...
R/cgat_function.R#L243       gc_count <- sum(bases %in% c("G",  ...
R/cgat_function.R#L244       gc_count / length(bases) * 100 ...
R/cgat_function.R#L247       bases <- strsplit(toupper(seq), "" ...
R/cgat_function.R#L248       as.integer(sum(bases == "N")) ...
R/cgat_function.R#L251   ) ...
R/cgat_function.R#L252    ...
R/cgat_function.R#L253   return(meta_df) ...
R/cgrplot.R#L53   # Get the sequence from the global fas ...
R/cgrplot.R#L54   sequence <- fasta_filtered[[seq_index] ...
R/cgrplot.R#L56   # Convert to uppercase and split into  ...
R/cgrplot.R#L57   sequence <- toupper(sequence) ...
R/cgrplot.R#L58   bases <- strsplit(sequence, "")[[1]] ...
R/cgrplot.R#L60   # Remove non-ACGT bases ...
R/cgrplot.R#L61   bases <- bases[bases %in% c("A", "C",  ...
R/cgrplot.R#L63   # Define corner positions for each bas ...
R/cgrplot.R#L64   corners <- list( ...
R/cgrplot.R#L69   ) ...
R/cgrplot.R#L71   # Initialize starting position (center ...
R/cgrplot.R#L72   current_pos <- c(0.5, 0.5) ...
R/cgrplot.R#L74   # Initialize matrix to store coordinat ...
R/cgrplot.R#L75   n_bases <- length(bases) ...
R/cgrplot.R#L76   cgr_coords <- matrix(0, nrow = n_bases ...
R/cgrplot.R#L77   colnames(cgr_coords) <- c("x", "y") ...
R/cgrplot.R#L79   # Calculate CGR coordinates ...
R/cgrplot.R#L80   for (i in seq_len(n_bases)) { ...
R/cgrplot.R#L83       # Move halfway to the corner of th ...
R/cgrplot.R#L84       corner <- corners[[base]] ...
R/cgrplot.R#L85       current_pos <- (current_pos + corn ...
R/cgrplot.R#L86       cgr_coords[i, ] <- current_pos ...
R/cgrplot.R#L88   } ...
R/cgrplot.R#L90   return(cgr_coords) ...
R/cgrplot.R#L118                      col = "black", ...) ...
R/cgrplot.R#L119   cgr_coords <- cgrplot(seq_index) ...
R/cgrplot.R#L121   if (is.null(main)) { ...
R/cgrplot.R#L123   } ...
R/cgrplot.R#L125   plot(cgr_coords[, 1], cgr_coords[, 2], ...
R/cgrplot.R#L132   ) ...
R/distances_and_export.R#L36   n <- nrow(distance_matrix) ...
R/distances_and_export.R#L37   seq_names <- rownames(distance_matrix) ...
R/distances_and_export.R#L38    ...
R/distances_and_export.R#L39   # Open file connection ...
R/distances_and_export.R#L40   con <- file(filename, "w") ...
R/distances_and_export.R#L41    ...
R/distances_and_export.R#L42   # Write header ...
R/distances_and_export.R#L43   writeLines("#mega", con) ...
R/distances_and_export.R#L44   writeLines("!Title: Distance Matrix;", ...
R/distances_and_export.R#L45   writeLines(paste0( ...
R/distances_and_export.R#L47   ), con) ...
R/distances_and_export.R#L48   writeLines("", con) ...
R/distances_and_export.R#L49    ...
R/distances_and_export.R#L50   # Write sequence names ...
R/distances_and_export.R#L51   writeLines("[", con) ...
R/distances_and_export.R#L52   for (i in seq_len(n)) { ...
R/distances_and_export.R#L54   } ...
R/distances_and_export.R#L55   writeLines("]", con) ...
R/distances_and_export.R#L56   writeLines("", con) ...
R/distances_and_export.R#L57    ...
R/distances_and_export.R#L58   # Write distance matrix (lower triangu ...
R/distances_and_export.R#L59   for (i in seq_len(n)) { ...
R/distances_and_export.R#L62       # FIX: was sapply(1:(i-1), ...); u ...
R/distances_and_export.R#L63       values <- vapply(seq_len(i - 1), f ...
R/distances_and_export.R#L65       }, FUN.VALUE = character(1)) ...
R/distances_and_export.R#L66       line <- paste0(line, paste(values, ...
R/distances_and_export.R#L69   } ...
R/distances_and_export.R#L70    ...
R/distances_and_export.R#L71   close(con) ...
R/distances_and_export.R#L72   # FIX: was message(paste(...)); messag ...
R/distances_and_export.R#L73   message("Distance matrix saved to ", f ...
R/distances_and_export.R#L123   n <- nrow(distance_matrix) ...
R/distances_and_export.R#L124   seq_names <- rownames(distance_matrix) ...
R/distances_and_export.R#L125    ...
R/distances_and_export.R#L126   # Truncate names if original mode ...
R/distances_and_export.R#L127   if (mode == "original") { ...
R/distances_and_export.R#L130   } ...
R/distances_and_export.R#L131    ...
R/distances_and_export.R#L132   # Open file connection ...
R/distances_and_export.R#L133   con <- file(filename, "w") ...
R/distances_and_export.R#L134    ...
R/distances_and_export.R#L135   # Write header (number of taxa) ...
R/distances_and_export.R#L136   writeLines(paste0("  ", n), con) ...
R/distances_and_export.R#L137    ...
R/distances_and_export.R#L138   # Write distance matrix ...
R/distances_and_export.R#L139   for (i in seq_len(n)) { ...
R/distances_and_export.R#L142       format(round(distance_matrix[i, j] ...
R/distances_and_export.R#L143              justify = "right") ...
R/distances_and_export.R#L148   } ...
R/distances_and_export.R#L149    ...
R/distances_and_export.R#L150   close(con) ...
R/distances_and_export.R#L151   # FIX: was message(paste(...)); messag ...
R/distances_and_export.R#L152   message("Distance matrix saved to ", f ...
R/distances_and_export.R#L191   n <- length(freq_matrices) ...
R/distances_and_export.R#L192   seq_names <- names(freq_matrices) ...
R/distances_and_export.R#L193    ...
R/distances_and_export.R#L194   # Initialize distance matrix ...
R/distances_and_export.R#L195   distance <- matrix(0, nrow = n, ncol = ...
R/distances_and_export.R#L196   rownames(distance) <- colnames(distanc ...
R/distances_and_export.R#L197    ...
R/distances_and_export.R#L198   # Calculate pairwise distances ...
R/distances_and_export.R#L199   for (i in seq_len(n)) { ...
R/distances_and_export.R#L201       distance[i, j] <- matrixDistance( ...
R/distances_and_export.R#L205       ) ...
R/distances_and_export.R#L207   } ...
R/distances_and_export.R#L208    ...
R/distances_and_export.R#L209   distance <- round(distance, 6) ...
R/distances_and_export.R#L210   return(distance) ...
R/distances_and_export.R#L252   # Set up global environment for cgat f ...
R/distances_and_export.R#L253   assign("fasta_filtered", sequences, en ...
R/distances_and_export.R#L254    ...
R/distances_and_export.R#L255   # Determine number of cores ...
R/distances_and_export.R#L256   if (is.null(num_cores)) { ...
R/distances_and_export.R#L259   } ...
R/distances_and_export.R#L260    ...
R/distances_and_export.R#L261   seq_names <- names(sequences) ...
R/distances_and_export.R#L262   n_seq <- length(sequences) ...
R/distances_and_export.R#L263    ...
R/distances_and_export.R#L264   process_sequence <- function(n) { ...
R/distances_and_export.R#L266   } ...
R/distances_and_export.R#L267    ...
R/distances_and_export.R#L268   # FIX: was message(paste(...)); messag ...
R/distances_and_export.R#L269   message("Processing ", n_seq, " sequen ...
R/distances_and_export.R#L270    ...
R/distances_and_export.R#L271   # Use parallel processing on Unix-like ...
R/distances_and_export.R#L272   if (.Platform$OS.type == "unix") { ...
R/distances_and_export.R#L274       seq_len(n_seq), ...
R/distances_and_export.R#L275       process_sequence, ...
R/distances_and_export.R#L276       mc.cores = num_cores ...
R/distances_and_export.R#L278   } else { ...
R/distances_and_export.R#L281   } ...
R/distances_and_export.R#L282    ...
R/distances_and_export.R#L283   names(freq_matrices) <- seq_names ...
R/distances_and_export.R#L284   message("Processing complete!") ...
R/distances_and_export.R#L285   return(freq_matrices) ...
vignettes/CGRphylo_introduction.Rmd#L54   recombinants ...
vignettes/CGRphylo_introduction.Rmd#L56   Clustal-Omega ...
vignettes/CGRphylo_introduction.Rmd#L92   ...
vignettes/CGRphylo_introduction.Rmd#L186   ...
vignettes/CGRphylo_introduction.Rmd#L205   ...
vignettes/CGRphylo_introduction.Rmd#L225   ...
vignettes/CGRphylo_introduction.Rmd#L257   ...
vignettes/CGRphylo_introduction.Rmd#L275   ...
vignettes/CGRphylo_introduction.Rmd#L377    A: (0,0), C: (1,0), G: (1,1), T: (0,1 ...
vignettes/CGRphylo_introduction.Rmd#L424    the SARS-CoV-2 Lineages, Newly Emergi ...
vignettes/CGRphylo_introduction.Rmd#L425    *Current Genomics*, 24(3). ...
vignettes/CGRphylo_introduction.Rmd#L428    *Nucleic Acids Research*, 18(8):2163- ...
vignettes/CGRphylo_introduction.Rmd#L431    classification of species assessed by ...
vignettes/CGRphylo_introduction.Rmd#L432    sequences. *Molecular Biology and Evo ...
Checking if package already exists in CRAN... OK
Checking for bioc-devel mailing list subscription...
Cannot determine whether maintainer is subscribed to the Bioc-Devel mailing list (requires admin credentials). Subscribe here: https://stat.ethz.ch/mailman/listinfo/bioc-devel
Checking for support site registration... OK
